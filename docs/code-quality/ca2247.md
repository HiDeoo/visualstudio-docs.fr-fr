---
title: 'ca2247 : l’argument passé au constructeur TaskCompletionSource doit être TaskCreationOptions enum au lieu de TaskContinuationOptions enum'
ms.date: 05/16/2020
ms.topic: reference
f1_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
helpviewer_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
author: stephentoub
ms.author: stoub
manager: jeffhand
ms.workload:
- multiple
ms.openlocfilehash: 8493471bd889d03dfed8e17855c17f7a4a905a19
ms.sourcegitcommit: 577c905de52057a741e68c2ed168ea527813fda5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/15/2020
ms.locfileid: "88248107"
---
# <a name="ca2247-argument-passed-to-taskcompletionsource-constructor-should-be-taskcreationoptions-enum-instead-of-taskcontinuationoptions-enum"></a>CA2247 : L’argument passé au constructeur TaskCompletionSource doit être l’enum TaskCreationOptions au lieu de l’enum TaskContinuationOptions

|Élément|Valeur|
|-|-|
|CheckId|CA2247|
|Category|Microsoft. usage|
|Modification avec rupture|Sans rupture|

## <a name="cause"></a>Cause

Construction d’un `System.Threading.Tasks.TaskCompletionSource` avec une <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valeur enum plutôt qu’une <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valeur enum.
Utilisation de la <xref:System.Object.ReferenceEquals%2A?displayProperty=fullName> méthode pour tester l’égalité d’un ou plusieurs types valeur.

## <a name="rule-description"></a>Description de la règle

Le type TaskCompletionSource a un constructeur qui accepte une <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valeur enum et un autre constructeur qui accepte un <xref:System.Object> .  Le passage accidentel d’une <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valeur enum à la place d’une <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valeur enum entraîne l’appel du <xref:System.Object> constructeur de base : il se compile et s’exécute, mais il n’a pas le comportement prévu.

## <a name="how-to-fix-violations"></a>Comment corriger les violations

Pour corriger la violation, remplacez la <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valeur enum par la <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valeur enum correspondante.

```csharp
    // Violation
    var tcs = new TaskCompletionSource<int>(TaskContinuationOptions.RunContinuationsAsynchronously);

    // Fixed
    var tcs = new TaskCompletionSource<int>(TaskCreationOptions.RunContinuationsAsynchronously);
```

## <a name="when-to-suppress-warnings"></a>Quand supprimer les avertissements

Une violation de cette règle met presque toujours en évidence un bogue dans le code appelant, de telle sorte que le code ne se comportera pas comme le développeur prévu, avec le TaskCompletionSource ignorant effectivement l’option spécifiée.  Le seul moment où il est possible de supprimer l’avertissement est que le développeur a réellement prévu de passer un boxed <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> comme argument d’état d’objet au TaskCompletionSource.

## <a name="see-also"></a>Voir aussi

- [Avertissements liés à l’utilisation](../code-quality/usage-warnings.md)
