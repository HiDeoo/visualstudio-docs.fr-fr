---
title: "CA1501 : Éviter l'excès d'héritage"
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1501
- AvoidExcessiveInheritance
helpviewer_keywords:
- AvoidExcessiveInheritance
- CA1501
ms.assetid: 9e934746-1a4d-492a-91e4-085201abafa4
author: mikejo5000
ms.author: mikejo
manager: jillfra
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
ms.openlocfilehash: 074f292c63b4baeac16a2729c6ffe16306ebc476
ms.sourcegitcommit: b885f26e015d03eafe7c885040644a52bb071fae
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/30/2020
ms.locfileid: "85528919"
---
# <a name="ca1501-avoid-excessive-inheritance"></a>CA1501 : Éviter l'excès d'héritage

|Élément|Valeur|
|-|-|
|CheckId|CA1501|
|Category|Microsoft. maintenabilité|
|Modification avec rupture|Rupture|

## <a name="cause"></a>Cause

Un type est imbriqué de plus de quatre niveaux dans sa hiérarchie d'héritage.

Par défaut, la règle exclut uniquement tous les types de l' `System` espace de noms, mais cela peut [être configuré](#configurability).

## <a name="rule-description"></a>Description de la règle

Les hiérarchies de type profondément imbriquées peuvent être difficiles à suivre, comprendre et gérer. Cette règle limite l’analyse aux hiérarchies du même module.

## <a name="how-to-fix-violations"></a>Comment corriger les violations

Pour corriger une violation de cette règle, dérivez le type d’un type de base qui est moins profond dans la hiérarchie d’héritage ou éliminez certains des types de base intermédiaires.

## <a name="when-to-suppress-warnings"></a>Quand supprimer les avertissements

Il est possible de supprimer sans risque un avertissement de cette règle. Toutefois, le code peut être plus difficile à gérer. Notez que, selon la visibilité des types de base, la résolution des violations de cette règle peut entraîner des modifications avec rupture. Par exemple, la suppression de types de base publics est une modification avec rupture.

## <a name="configurability"></a>Configurabilité

### <a name="inheritance-excluded-type-or-namespace-names"></a>Nom du type ou de l’espace de noms exclu de l’héritage

Vous pouvez configurer des noms de types ou d’espaces de noms (séparés par' | '), de telle sorte que l’espace de noms du type ou du type ne soit pas compté dans l’arborescence de la hiérarchie d’héritage. Par défaut, tous les types de l' `System.*` espace de noms sont exclus. Notez que quelle que soit la valeur que vous définissez, cette valeur par défaut est ajoutée.

| Valeur d’option | Résumé |
| --- | --- |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = MyType` | Correspond à tous les types nommés’MyType’ou dont l’espace de noms contenant contient’MyType’et tous les types de l’espace de noms’System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = MyType1\|MyType2` | Correspond à tous les types nommés « MyType1 » ou « MyType2 » ou dont l’espace de noms contenant contient « MyType1 » ou « MyType2 » et tous les types de l’espace de noms « System ». |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS.MyType` | Correspond au type spécifique’MyType’dans l’espace de noms’NS’et tous les types de l’espace de noms’System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS1.MyType1\|T:NS2.MyType2` | Met en correspondance les types spécifiques’MyType1 'et’MyType2 'avec les noms qualifiés complets respectifs et tous les types de l’espace de noms’System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = N:NS` | Correspond à tous les types de l’espace de noms’NS’et à tous les types de l’espace de noms’System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = My*` | Correspond à tous les types dont le nom commence par « My » ou dont les parties de l’espace de noms contenant commencent par « My » et tous les types de l’espace de noms « System ». |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS.My*` | Correspond à tous les types dont le nom commence par « My » dans l’espace de noms « NS » et tous les types de l’espace de noms « System ». |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = N:My*` | Correspond à tous les types dont l’espace de noms conteneur commence par’My’et tous les types de l’espace de noms’System' |

## <a name="example"></a>Exemple

L’exemple suivant montre un type qui viole la règle :

[!code-csharp[FxCop.Maintainability.ExcessiveInheritance#1](../code-quality/codesnippet/CSharp/ca1501-avoid-excessive-inheritance_1.cs)]
[!code-vb[FxCop.Maintainability.ExcessiveInheritance#1](../code-quality/codesnippet/VisualBasic/ca1501-avoid-excessive-inheritance_1.vb)]
