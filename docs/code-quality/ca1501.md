---
title: "CA1501 : Éviter l'excès d'héritage"
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1501
- AvoidExcessiveInheritance
helpviewer_keywords:
- AvoidExcessiveInheritance
- CA1501
ms.assetid: 9e934746-1a4d-492a-91e4-085201abafa4
author: mikejo5000
ms.author: mikejo
manager: jillfra
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
ms.openlocfilehash: 4006bc2fe9923f6c0f5f4ecb6bec51073c19242e
ms.sourcegitcommit: ade07bd1cf69b8b494d171ae648cfdd54f7800d3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/21/2020
ms.locfileid: "81649130"
---
# <a name="ca1501-avoid-excessive-inheritance"></a>CA1501 : Éviter l'excès d'héritage

|||
|-|-|
|TypeName|AvoidExcessiveInheritance|
|CheckId|CA1501|
|Category|Microsoft.Maintainability (en)|
|Modification avec rupture|Rupture|

## <a name="cause"></a>Cause

Un type est imbriqué de plus de quatre niveaux dans sa hiérarchie d'héritage.

Par défaut, la règle n’exclut que tous les types de l’espace `System` nom, mais [c’est configurable](#configurability).

## <a name="rule-description"></a>Description de la règle

Les hiérarchies de type profondément imbriquées peuvent être difficiles à suivre, comprendre et gérer. Cette règle limite l’analyse aux hiérarchies dans le même module.

## <a name="how-to-fix-violations"></a>Comment corriger les violations

Pour corriger une violation de cette règle, dérivez le type d’un type de base qui est moins profond dans la hiérarchie de l’héritage ou éliminez certains des types de base intermédiaires.

## <a name="when-to-suppress-warnings"></a>Quand supprimer les avertissements

Il est sûr de supprimer un avertissement de cette règle. Cependant, le code pourrait être plus difficile à maintenir. Notez que, selon la visibilité des types de base, la résolution des violations de cette règle peut créer des changements de rupture. Par exemple, la suppression des types de base publique est un changement de rupture.

## <a name="configurability"></a>Configurabilité

### <a name="inheritance-excluded-type-or-namespace-names"></a>Héritage exclus noms de type ou d’espace de nom

Vous pouvez configurer les noms des types ou des espaces nominaux (séparés par ''), de sorte que l’espace nom du type ou du type ne compte pas dans l’arbre de hiérarchie d’héritage. Par défaut, tous `System.*` les types de l’espace nom sont exclus. Notez que quelle que soit la valeur que vous définissez, cette valeur par défaut sera ajoutée.

| Valeur d’option | Résumé |
| --- | --- |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = MyType` | Correspond à tous les types nommés 'MyType' ou dont l’espace de nom contenant contient 'MyType' et tous les types de l’espace de nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = MyType1\|MyType2` | Correspond à tous les types nommés 'MyType1' ou 'MyType2' ou dont l’espace de nom contient 'MyType1' ou 'MyType2' et tous les types de l’espace nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS.MyType` | Correspond à type spécifique 'MyType' dans l’espace nom 'NS' et tous les types de l’espace de nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS1.MyType1\|T:NS2.MyType2` | Correspond à des types spécifiques 'MyType1' et 'MyType2' avec des noms respectifs entièrement qualifiés et tous les types de l’espace de nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = N:NS` | Correspond à tous les types de l’espace de nom 'NS' et tous les types de l’espace de nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = My*` | Correspond à tous les types dont le nom commence par 'My' ou dont les parties contenant des espaces nom commence par 'My' et tous les types de l’espace nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = T:NS.My*` | Correspond à tous les types dont le nom commence par 'My' dans l’espace nom 'NS' et tous les types de l’espace nom 'System' |
|`dotnet_code_quality.CA1501.additional_inheritance_excluded_symbol_names = N:My*` | Correspond à tous les types dont l’espace de nom contenant commence par 'My' et tous les types de l’espace de nom 'System' |

## <a name="example"></a>Exemple

L’exemple suivant montre un type qui viole la règle :

[!code-csharp[FxCop.Maintainability.ExcessiveInheritance#1](../code-quality/codesnippet/CSharp/ca1501-avoid-excessive-inheritance_1.cs)]
[!code-vb[FxCop.Maintainability.ExcessiveInheritance#1](../code-quality/codesnippet/VisualBasic/ca1501-avoid-excessive-inheritance_1.vb)]
