---
title: C6381
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- C6381
helpviewer_keywords:
- C6381
ms.assetid: c01a3040-26d4-47ac-b72d-7e1292ca435f
author: mikeblome
ms.author: mblome
manager: markl
ms.workload:
- multiple
ms.openlocfilehash: 2bc23de0d8f5257204c7f6fd3b2310513626c3a9
ms.sourcegitcommit: 535ef05b1e553f0fc66082cd2e0998817eb2a56a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/07/2019
ms.locfileid: "72017433"
---
# <a name="c6381"></a>C6381
AVERTISSEMENT C6381 : L’API Shutdown \<function > requiert un dwReason ou un lpMessage valide valide

Cet avertissement est émis si InitiateSystemShutdownEx est appelé :

- Sans passer une raison d’arrêt valide (dwReason). Si le paramètre dwReason est égal à zéro, la valeur par défaut est un arrêt non défini. Par défaut, il s’agit également d’un arrêt non planifié. Vous devez utiliser l’un des codes de raison de l’arrêt du système pour ce paramètre.

- Sans passer de message d’arrêt (lpMessage valide).

Nous vous recommandons d’utiliser les paramètres appropriés lors de l’appel de cette API pour aider les administrateurs système à déterminer la cause de l’arrêt.

## <a name="example"></a>Exemple

Le code suivant génère cet avertissement, car dwReason est égal à zéro et lpMessage valide a la valeur NULL :

```cpp
void f()
{
  //...
  BOOL bRet;
  bRet = InitiateSystemShutdownEx( NULL,
                                   NULL, // message
                                   0,
                                   FALSE,
                                   TRUE,
                                   0);  // shutdown reason
  // ...
}
```

Pour corriger cet avertissement, spécifiez dwReason et lpMessage valide, comme indiqué dans le code suivant :

```cpp
#include <windows.h>
void f()
{
  //...
  BOOL bRet;
  bRet = InitiateSystemShutdownEx( NULL,
                               "Hardware Failure",  // message
                               0,
                               FALSE,
                               TRUE,
                               SHTDN_REASON_MAJOR_HARDWARE ); // reason
  // ...
}
```